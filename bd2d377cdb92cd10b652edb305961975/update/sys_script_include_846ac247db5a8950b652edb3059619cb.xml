<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>package_private</access>
        <active>true</active>
        <api_name>x_snc_parcel.HtmlRenderParcelLabelA4</api_name>
        <caller_access/>
        <client_callable>false</client_callable>
        <description/>
        <name>HtmlRenderParcelLabelA4</name>
        <script><![CDATA[function HtmlRenderParcelLabelA4(grParcel)
{
	var GetStringValue = x_snc_devtools.GetStringValue;
	var IsValidRecord = x_snc_devtools.IsValidRecord;
	var GetRecord = x_snc_devtools.GetRecord;
	
	var strHtml = '';
	
	if (IsValidRecord(grParcel) == false)
	{
		strHtml += '<p style="text-color: red;">ERROR!</p>';
		return strHtml;
	}
	
	var strUrl = GetParcelScanPageURL(grParcel.sys_id);

	function StringLengthToFontSize(nLength)
	{
		var GetIntegerValue = x_snc_devtools.GetIntegerValue;
		nLength = GetIntegerValue(nLength);
		if (nLength <= 5)
		{
			return '1500%';
		}
		if (nLength <= 7)
		{
			return '1200%';
		}		
		if (nLength <= 10)
		{
			return '600%';
		}
		if (nLength <= 15)
		{
			return '450%';
		}
		if (nLength <= 20)
		{
			return '350%';
		}	
		if (nLength <= 30)
		{
			return '300%';
		}			
		return '100%';
	}

	/*
	strHtml += '<div style="font-size: '+StringLengthToFontSize(5)+';">12345</div>';
	strHtml += '<div style="font-size: '+StringLengthToFontSize(7)+';">1234567</div>';
	strHtml += '<div style="font-size: '+StringLengthToFontSize(10)+';">1234567890</div>';
	strHtml += '<div style="font-size: '+StringLengthToFontSize(15)+';">123456789012345</div>';
	strHtml += '<div style="font-size: '+StringLengthToFontSize(20)+';">12345678901234567890</div>';
	strHtml += '<div style="font-size: '+StringLengthToFontSize(30)+';">123456789012345678901234567890</div>';

	strHtml += '<div style="font-size: '+StringLengthToFontSize(5)+ ';">ABCDE</div>';
	strHtml += '<div style="font-size: '+StringLengthToFontSize(7)+ ';">ABCDEFG</div>';
	strHtml += '<div style="font-size: '+StringLengthToFontSize(10)+';">ABCDEFGHIJ</div>';
	strHtml += '<div style="font-size: '+StringLengthToFontSize(15)+';">ABCDEFGHIJABCDE</div>';
	strHtml += '<div style="font-size: '+StringLengthToFontSize(20)+';">ABCDEFGHIJABCDEFGHIJ</div>';
	strHtml += '<div style="font-size: '+StringLengthToFontSize(30)+';">ABCDEFGHIJABCDEFGHIJABCDEFGHIJ</div>';
	*/

	
	//strHtml += '<div id="qrcode" style="width:100%; margin-top:15px;" url="'+strUrl+'" height="500" width="500"></div>';
	
	
	
	function HtmlRenderBitmap(aBitmap/*, nWidth*/)
	{
		
		//var arr = aRawData;
		
		if (x_snc_devtools.GetType(aBitmap) != 'Array')
		{
			return '';
		}
		
		
		//var xpos = 4.0; // cm from left
		var xpos = 0; // cm from left

		//var ypos = 4.0; // cm from top
		var ypos = 4;
		var color = "background-color: #000;";
		//var nWidth = (21.0 - 2*xpos); // qr: 80% of page width without margin	
		var nWidth = 12.0; 


		var width = nWidth / aBitmap.length;

		
		var strHtml = '';
		strHtml += '<div style="position: absolute; width: 13cm;">';
		
		for (var nRow = 0; nRow < aBitmap.length; nRow++)
		{
			var aRow = aBitmap[nRow];
			for (var nCol = 0; nCol < aRow.length; nCol++)
			{
				if (aBitmap[nRow][nCol] == true)
				{
					strHtml += '<div style="position: absolute;'
						+ ' left: ' + ((nRow * width) + xpos) + 'cm;'
						+ ' top: ' + ((nCol * width) + ypos) + 'cm;'
						+ ' width: ' + width +'cm;'
						+ ' height: ' + width +'cm;'
						+ color + '"/>';
				}
			}
		}
		strHtml += '</div>';
		return strHtml;
	}
	
	// PARCEL NUMBER
	strHtml += '<div style="font-size: '+StringLengthToFontSize(GetStringValue(grParcel.number).length)+';">' + grParcel.number + '</div>';

	// TEXT
	var strText = GetStringValue(grParcel.text);
	if (strText != '')
	{
		strHtml += '<div style="font-size: 100%;">';
		strHtml += strText+' ';
		strHtml += '</div>';
	}	

	// QR CODE
	var aQRCode = x_snc_devtools.CreateQRCodeRawData(GetParcelScanPageURL(grParcel.sys_id));
	strHtml += HtmlRenderBitmap(aQRCode);

	strHtml += '<div style="height: 13cm;"/>';
	
	// SHIP TO
	var grLocation = GetRecord('cmn_location',grParcel.destination);
	if (IsValidRecord(grLocation))
	{
		strHtml += '<div style="font-size: 350%;"><b>SHIP TO</b></div>'
		strHtml += '<div style="font-size: 200%; line-height: 130%;">';
			strHtml += '<div>'+grLocation.name+'</div>';
			strHtml += '<div>'+GetStringValue(grLocation.street).replace('\n', '<br/>')+'</div>';
			strHtml += '<div>'+grLocation.zip+' '+grLocation.city+' '+grLocation.state+' '+grLocation.country+'</div>';
		strHtml += '</div>';
		
	}

	// SHIP FROM
	var grLocationSender = GetRecord('cmn_location',grParcel.sender);
	if (IsValidRecord(grLocationSender))
	{
		strHtml += '<div style="font-size: 100%; margin-top: 10px; border-top: solid; border-width: thick; padding-top: 3px;">';
		strHtml += '<b>SHIP FROM</b> ';
		strHtml += grLocationSender.name+' ';
		strHtml += grLocationSender.street+' ';
		strHtml += grLocationSender.zip+' '+grLocationSender.city+' '+grLocationSender.state+' ';
		strHtml += grLocationSender.country;		
		strHtml += '</div>';
	}	

	// TASK/CASE
	var grTask = GetRecord('task',grParcel.task);
	if (IsValidRecord(grTask))
	{
		strHtml += '<div style="font-size: 100%; margin-top: 10px; border-top: solid; border-width: thick; padding-top: 3px;">';
		strHtml += '<b>TASK/CASE</b> ';
		strHtml += grTask.number+' ';
		strHtml += '</div>';
	}

	function HtmlRenderPageA4(strContent)
	{
		var strHtml = '';
		
		strHtml += '<div style="width: 21cm; height: 29.7cm; border: 0px; padding: 1cm 1cm 1cm 1cm;">';
			strHtml += '<div style="width: 18.9cm; height: 27.6cm;">';
				strHtml += strContent;
			strHtml += '</div>';
		strHtml += '</div>';
		return strHtml;
	}	
	
	strHtml = HtmlRenderPageA4(strHtml);
	
	return strHtml;
}]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2022-03-22 09:53:20</sys_created_on>
        <sys_id>846ac247db5a8950b652edb3059619cb</sys_id>
        <sys_mod_count>48</sys_mod_count>
        <sys_name>HtmlRenderParcelLabelA4</sys_name>
        <sys_package display_value="Parcel WORK IN PROGRESS" source="x_snc_parcel">bd2d377cdb92cd10b652edb305961975</sys_package>
        <sys_policy>read</sys_policy>
        <sys_scope display_value="Parcel WORK IN PROGRESS">bd2d377cdb92cd10b652edb305961975</sys_scope>
        <sys_update_name>sys_script_include_846ac247db5a8950b652edb3059619cb</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2022-03-22 18:15:09</sys_updated_on>
    </sys_script_include>
</record_update>
